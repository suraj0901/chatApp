<link rel="stylesheet" href="./style.css" />
<form action="/message" method="POST" target="_parent">
  <section>
    <label for="name">Name</label>
    <input type="text" id="name" name="name" />
  </section>
  <textarea
    name="message"
    id="chat"
    cols="30"
    rows="3"
    placeholder="...message"
  ></textarea>
  <button type="submit">Send</button>
</form>

<section id="container"></section>

<script>
  const messageElement = ({ name, message }) => {
    const div = document.createElement('div');
    div.className = 'message';
    div.innerHTML = `
    <p>${name}</p>
    <h3>${message}</h3>
  `;
  };

  const main = async () => {
    const container = document.getElementById('container');
    try {
      const messages = JSON.parse(await fetch('/message'));
      messages.forEach((message) => {
        const div = messageElement(message);
        container.append(div);
      });
    } catch (err) {
      console.log(err);
    }
  };

  main();
</script>
